
1. 카운트 만들기

앞으로 만들게 될 것
[https://counter.now.sh/](https://counter.now.sh/)


상단의 생성,제거 버튼을 누르면 동그라미가 나타나거나 사라지고, 동그라미를 왼쪽 클릭하면 더하기, 오른쪽 클릭하면 빼기, 더블클릭하면 색상이 변하는 카운터 어플리케이션


Redux를 이해하기 위한 첫 걸음!!

이 곳에서 다룰 내용은 리덕스를 통하여 하나의 카운터만 관리하는 프로젝트.
전체 코드는           [https://github.com/vlpt-playground/redux-counter/tree/single-counter](https://github.com/vlpt-playground/redux-counter/tree/single-counter)

### 1-1 작업환경 설정

create-react-app을 통한 프로젝트 생성

`create-react-app redux-counter`

그 다음 내부로 들어가 redux와 react-redux를 yarn을 통하여 설치하기.

`yarn add redux react-redux`

>react-redux 는 redux를 컴포넌트 상에서 더 간편하게 사용 할 수 있게 해 주는 라이브러리입니다. 이걸 사용하면, 컴포넌트에서 store 를 props 으로 받아오거나, subscribe 를 직접 할 필요가 없습니다.

**프로젝트 초기화**
- App.css
- App.js
- App.test.js
- logo.svg

제거하기

**디렉토리 생성**

src 디렉토리 내부에 다음과 같은 디렉토리를 만들기
- actions:액션타입, 액션생성자 파일이 저장
- components:뷰만을 담당하는 `presentational`컴포넌트들을 저장
- containers: store에 접근이 닿는 container 컴포넌트들이 저장됨
- reducers: 스토어의 기본상태와, 상태의 업데이트를 담당하는 리듀서 파일들이 저장됩니다.
- utils: 일부 컴포넌트들에서 공용되는 파일이 저장.

### 1-2 presentational 컴포넌트와 Container컴포넌트

프리젠테이셔널 컴포넌트와 컨테이너컴포넌트는, 리덕스를 사용하는 프로젝트에서 자주 사용되는 구조입니다.
흔히, Dumb컴포넌트와 Smart컴포넌트로도 알려져있습니다.

#### 프리젠테이셔널 컴포넌트
프리젠테이셔널 컴포넌트는 오직 뷰만을 담당하는 컴포넌트입니다. 이 안에는 DOM엘리먼트, 그리고 스타일을 갖고 있으며, 프리젠테이셔널 컴포넌트나 컨테이너 컴포넌트를 가지고 있을 수도 있습니다. 하지만, 리덕스의 스토어에는 직접적인 접근권한이 없으며, 오직 props로만 데이터를 가져올 수 있습니다. 또한 대부분의 경우 state를 갖고있지 않으며, 갖고있을 경우엔 데이터에 관련된것이 아니라 UI에 관련된 것이여야 합니다.

주로 함수형 컴포넌트로 작성되며, state를 갖고 있어야하거나, 최적화를 위해 LifeCycle이 필요해질때 클래스형 컴포넌트로 작성됩니다.

#### 컨데이터 컴포넌트
 이 컴포넌트는 프리젠테이셔널 컴포넌트들과 컨테이너 컴포넌트들을 관리하는 것을 담당합니다. 주로 내부에 DOM엘리먼트가 직접적으로 사용되는 경우는 없습니다. 사용되는 경우는 감싸는 용도일때만 사용됩니다. 또한 스타일을 가지고 있지 않아야합니다. 스타일들은 모두 프리젠테이셔널 컴포넌트에서 정의되어야 합니다. 상태를 가지고 있을 때가 많으며, 리덕스에 직접적으로 접근 할 수 있습니다.

### 이 구조의 장점

UI쪽과 Data쪽이 분리되어 프로젝트를 이해하기 쉬워지며, 컴포넌트의 재사용률도 높여줍니다.

#### 어떤걸 컨데이터로 만들어야 할까?

- 페이지
- 리스트
- 헤더
- 사이드바
- 내부의 컴포넌트 때문에 Props가 여러 컴포넌트를 거쳐야 하는 경우

**오해**
컨테이너 컴포넌트라고해서 무조건 그 내부에 여러개의 컴포넌트가 있어야하는것이 아닙니다. 예를 들어 Item이란 프리젠테이셔널 컴포넌트가 있다면, ItemContainer라는 컴포넌트를 만들어서 그 안에 Item컴포넌트 하나만 넣고 데이터를 연결해주는 것도 가능합니다.

추가적으로, 어떤걸 컨테이너로 만들지, 그리고 이 구조를 사용할지는 여러분의 자유입니다. 이 구조는 리덕스의 창시자 Dan Abramov가 공유한 구조이긴하나, 무조건 따라야 할 규칙이 아닙니다. 따라하면 유용한 팁일수도 있고, 어쩌면 여러분들의 개발 흐름에 어울리지않을수도 있습니다. 무조건 프리젠테이셔널 컴포넌트로 분리하지 않고, 그냥 DOM엘리먼트를 지닌 컴포넌트에 직접 리덕스를 연결해도 상관없습니다. 그러다 나중에 컴포넌트를 재사용을 해야될 때쯤 다시 분리시켜도 되구요.

### 1-3 기본적인 틀 만들기

아까 우리가 대부분의 파일을 지웠으니, 다시 만들어 주겠습니다. 우선 Container디렉토리에 비어있는 App컴포넌트를 만들어 주세요.

```javascript
import React, { Component } from 'react';

class App extends Component {
    render() {
        return (
            <div>
                Counter
            </div>
        );
    }
}

export default App;
```

```javascript
import React from 'react';
import ReactDOM from 'react-dom';
import App from './containers/App';
import './index.css';

ReactDOM.render(
  <App />,
  document.getElementById('root')
);
```
### 1-4 Counter 컴포넌트 만들기

우리의 첫 프리젠테이셔널 컴포넌트인 카운터 컴포넌트를 만들어보겠습니다. 이 컴포넌트는 숫자, 색상값과 더하기, 빼기 그리고 색상변경 함수 3개를 props로 전달받는 컴포넌트입니다.

src/components/Counter.js

```javascript
import React from 'react';
import PropTypes from 'prop-types';
import './Counter.css';

const Counter = ({number, color, onIncrement, onDecrement, onSetColor}) => {
    return (
        <div
            className="Counter"
            onClick={onIncrement}
            onContextMenu={
                (e) => {
                    e.preventDefault();
                    onDecrement();
                }
            }
            onDoubleClick={onSetColor}
            style={{backgroundColor: color}}>
            {number}
        </div>
    );
};

Counter.propTypes = {
    number: PropTypes.number,
    color: PropTypes.string,
    onIncrement: PropTypes.func,
    onDecrement: PropTypes.func,
    onSetColor: PropTypes.func
};

Counter.defaultProps = {
    number: 0,
    color: 'black',
    onIncrement: () => console.warn('onIncrement not defined'),
    onDecrement: () => console.warn('onDecrement not defined'),
    onSetColor: () => console.warn('onSetColor not defined')
};

export default Counter;
```

여기서 onContextMenu는 우클릭을 하여 메뉴가 열리는 이벤트를 의미하는데요. 이 함수가 실행될때, e.preventDefault()를 실행하면 메뉴가 열리지 않게 됩니다.

카운터의 기본 숫자는 0, 기본 색상은 검정색으로 설정하였습니다.

그럼 이제 스타일을 정의해봅시다.
`src/components/Counter.css`

```css
.Counter {
    /* 레이아웃 */
    width: 10rem;
    height: 10rem;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 1rem;

     /* 색상 */
    color: white;

    /* 폰트 */
    font-size: 3rem;

    /* 기타 */
    border-radius: 100%;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.75s;
}
```

컴포넌트를 동그라미 모양으로, 숫자는 가운데에 위치시키고 흰색으로 설정하였습니다.

이 컴포넌트가 어떻게 보여지는지 확인하기 위하여, App.js에서 임시로 불러와서 렌더링해보세요. 그리고, 왼쪽클릭, 오른쪽클릭, 더블클릭을 해서 우리가 각 이벤트에 지정한 기본 함수가 제대로 실행 되는지 확인하세요.

잘 되었다면 성공! 다음으로 넘어가세요.

### 1-5 Actions 만들기
ActionTypes 준비하기

이제 드디어 Redux스러운 것을 할 차례입니다. 우리가 이제 액션을 정의할 건데요. 우선 리뷰를 해보자면, action은 하나의 객체라고 했었죠? 모든 액션 객체는 type이라는 값을 지니고 있어야 합니다.

```javascript
{
    type: "INCREMENT"
}
```

```javascript
{
    type: "DECREMENT"
}
```

만약에 액션과 함께 전달해야 할 값이 있을 경우엔 추가해서 만들어주면 되지요.

```javascript
{
    type: "SET_COLOR",
    color: "black"
}
```

여기서 이 `type`은 액션의 이름과도 같은 존재입니다. 나중에 리듀서가 액션을 전달받으면 이 값에 따라서 다른 작업을 하기도 합니다.

그런데, 이 값을, 사용 할 때 마다 모두 그냥 문자열로 사용한다면 관리하기 조금 힘들어질 수 도 있는데요. 이 값들을 따로 파일로 만들어서 저장하면 조금 편리 해진답니다.

우선,action디렉토리에 `ActionTypes.js`라는 폴더를 만들어서 다음과 같이 상수들을 선언하세요.
`src/actions/ActionTypes.js`

```javascript
/*
 Action 의 종류들을 선언합니다.
 앞에 export 를 붙임으로서, 나중에 이것들을 불러올 때,
 import * as types from './ActionTypes' 를 할 수 있어요.
*/

export const INCREMENT = 'INCREMENT';
export const DECREMENT = 'DECREMENT';
export const SET_COLOR = 'SET_COLOR';
```

액션을 선언할때에는, 위와 같이, 대문자로 선언하시면 됩니다.

**액션 생성자 만들기**
액션을 만들때마다 객체를 그때그때 만들기는 힘들겠죠? 그래서 우리는 액션을 만드는 함수를 만들겠습니다. 이를 **액션 생성자** 라고 부릅니다. actions디렉토리에 `index.js`파일을 만들어서 다음 함수를 만드세요.

```javascript
/*
    action 객체를 만드는 액션 생성자들을 선언합니다. (action creators)
    여기서 () => ({}) 은, function() { return { } } 와 동일한 의미입니다.
    scope 이슈와 관계 없이 편의상 사용되었습니다.
*/

import * as types from './ActionTypes';

export const increment = () => ({
    type: types.INCREMENT
});

export const decrement = () => ({
    type: types.DECREMENT
});

// 다른 액션 생성자들과 달리, 파라미터를 갖고있습니다
export const setColor = (color) => ({
    type: types.SET_COLOR,
    color
});
```
