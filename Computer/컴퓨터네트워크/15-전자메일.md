# 전자메일 사용자환경

**전자메일기능**  
\- 메일 편집  
\- 메일 내용 읽기  
\- 수신 메일 관리  
\- 전달 여부 통지  
\- 메일 전송(Relay)  



- 전자 메일 주소 ( <로그인 이름> @ <메일 서버 이름>)
- 메일 프로그램 - 클라이언트 프로그램

#### 메일 메시지

- 기본적으로 ASCII코드 기반의 텍스트만을 전송

- 멀티미디어 데이터를 수용하기 위한 기능 확장(MIME : Multipurpose Internet Mail Extensions)

- 구성

  \- 헤더  
  \- 빈 줄  
  \- 본문(마지막 줄은 마침표(.)만)

- 메시지 헤더

  | 헤더    | 의미                                                         |
  | ------- | ------------------------------------------------------------ |
  | To      | 수신자의 전자메일 주소                                       |
  | CC      | 참조 수신자의 전자메일 주소                                  |
  | BCC     | 참조 수신자의 전자메일 주소,여기에 포함된 주소는 수신자가 확인할 수 없음 |
  | From    | 송신자의 이름                                                |
  | Sender  | 송신자의 전자메일 주소                                       |
  | Date    | 메시지가 전송된 시간                                         |
  | Subject | 메시지 제목                                                  |

#### MIME ( Multipurpose Internet Mail Extension)

- 실행파일, 음성, 영상 등 멀티미디어 데이터를 수용하기 위한 기능 확장

- MIME 처리

  - 메일 송신 전에 비-ASCII 데이터를 ASCII 데이터로 변환
  - 메일 수신 전에 ASCII데이터를 비-ASCII 데이터로 변환
    ![](https://ws2.sinaimg.cn/large/006tKfTcgy1fofoz889lqj30r70inwil.jpg)

- MIME 헤더

  ![](https://ws4.sinaimg.cn/large/006tKfTcgy1fofozldy8lj31ep0mlwrn.jpg)

- MIME 데이터 종류

![](https://ws2.sinaimg.cn/large/006tKfTcgy1fofp0cjgndj312o0wn4db.jpg)



### 전자메일 시스템 구조

- 사용자 환경 : 메일 응용 프로그램인 사용자 에이전트(UA)

- 네트워크 환경 : 메일을 중개하고 송수신하는 메일 전송 에이전트(MTA)

  ![](https://ws4.sinaimg.cn/large/006tKfTcgy1fofp1l8n01j31b80ojaj5.jpg)



### 사용자 에이전트(UA User Agent)

- 메일을 송수신하는 용도의 응용 프로그램

- 사용자 작업환경 제공(표준화된 형식 없음)

- 사용자 화면 예

- 사용자 프로그램 입력정보는 표준화된 형식으로 정의

  - 송신자의 메일 주소
  - 수신자의 메일 주소
  - 참조자의 메일 주소
  - 메일의 메시지 헤더 : 메일 제목 등
  - 메일의 메시지 본문 : 메일 내용

  ![](https://ws1.sinaimg.cn/large/006tKfTcgy1fofp3omrpgj30rg0iraj6.jpg)



### 메일 전송 에이전트(MTA Mail Transfer Agent)

- 받은 메일 서버 : POP(Post Office Protocol) 프로토콜
- 보내는 메일 서버 : SMTP(Simple Mail Transfer Protocol) 프로토콜



#### SMTP와  POP서비스의 관계

![](https://ws2.sinaimg.cn/large/006tKfTcgy1fofp56z690j31g30wfnac.jpg)



#### SMTP 이용 과정

- 메일을 보내는 과정
  - SMTP클라이언트와 SMTP서버 사이의 TCP연결을 설정하는 단계
  - SMTP서버에 메일을 보내는 데이터 전송 단계
  - 메일 전송을 완료하고 TCP연결을 종료하는 단계
- 하나 이상의 SMTP서버에 메일 전송
  - 서버로의 접근 가능성 확인
  - 서버와의 연결 설정
  - 메일 전송
- 서버와 직접 연결이 불가능한 경우에도 동작
  - 메시지 저장과 중개 방식



#### SMTP의 명령과 응답

\- SMTP명령 (command)
![](https://ws1.sinaimg.cn/large/006tKfTcgy1fofpakgnz3j31690uowt5.jpg)



\- SMTP 응답(response)

- 3자리 코드와 추가정보로 구성

![](https://ws4.sinaimg.cn/large/006tKfTcgy1fofpb7jkzzj31cq0gkjzi.jpg)



- Well-Known 포트 : TCP 25번
- 서버 응답
  - 수신 준비 OK:220
  - 준비가 안된 경우 : 421
- 클라이언트 : HELLO
- 서버 응답 : 250



![](https://ws1.sinaimg.cn/large/006tKfTcgy1fofpc9gb4vj30v10pxjuh.jpg)





1. 25번 포트인 SMTP서버에 연결 시도
2. 연결이 성공하면 telnet 명령과 관련된 결과 출력
3. 응답 메시지 수신
4. 키보드로 'HELO kihyun.uu.ac.kr'을 입력
5. 응답 메시지 회신, SMTP 세션의 성공을 알림

![](https://ws4.sinaimg.cn/large/006tKfTcgy1fofpqelbinj31910etdm6.jpg)



- 명령과 응답
- 메일 주소 확인 과정 (MAIL FROM / RCPT TO)
- 헤더 정보 전송 과정(DATA / From : /To: / Data:)
- 메시지 전송 과정(빈 줄 / 송신 메시지 / 점(.))

![](https://ws3.sinaimg.cn/large/006tKfTcgy1fofps9c4uzj30wb0zwq9y.jpg)



#### 연결 해제

- 명령과 응답

  - 클라이언트 QUIT 요청
  - 서버에서 211로 회신

  ![](https://ws3.sinaimg.cn/large/006tKfTcgy1fofpt693p5j319d0lnjv8.jpg)



## POP(Post Office Protocol)

- SMTP : 전자 메일을 송수신하는 호스트 사이에 필요한 프로토콜

- POP: 전자메일 서버에 보관된 메일을 개인용 PC로 다운로드 하는 프로토콜

- POP

  - POP명령과 POP응답
  - Well-Known 포트 : TCP 110번
  - 메일 다운로드 과정에서 사용자 인증허가가 반드시 필요

- SMTP

  - SMTP 명령과 SMTP 응답
  - Well-Known 포트 : TCP 25번
  - 메일 송수신 과정에서 사용자 인증허가가 불필요

- POP 명령

  ![](https://ws2.sinaimg.cn/large/006tKfTcgy1fofpwcqtjjj31910ux7lj.jpg)

- POP 응답

  ![](https://ws3.sinaimg.cn/large/006tKfTcgy1fofpx8pfm9j30zb0bl784.jpg)



### POP 동작 시나리오

- 사용자 인증
  - USER
  - PASS
- 메일 다운로드
  - STAT - 배달된 메일 개수 반환
  - LIST
  - RETR - 메일 데이터 다운로드 / 원본은 서버에 존재
  - DELE
- 세션 종료
  - QUIT
- telnet을 이용한 시뮬레이션
  - 메일 주소 : lenKIm@gmail.com
  - 메일서버 : gmail.com
  - POP 서버 : gmail.com
  - 클라이언트 : telnet플그램

![](https://ws4.sinaimg.cn/large/006tKfTcgy1fofq16y14hj314v0i6q98.jpg)

