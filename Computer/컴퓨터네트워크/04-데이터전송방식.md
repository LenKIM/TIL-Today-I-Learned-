## 데이터 전송의 기초

물리적인 전송 오류를 해결하는 것이 계층 2 프로토콜의 가장 중요한 역할이다.



#### 네트워크 효과

- 자원공유  
  \-  컴퓨터 하드웨어 외에 물리적, 논리적 정보 공유
- 병렬 처리에 의한 성능향상  
  \- 네트워크 속도 제한에 의한 한계  
  \- 네트워크 성능 개선으로 병렬 처리 가능
- 중복 저장으로 인한 신뢰성 향상  
  \- 일관성 문제  
  \- 데이터 갱신 비용

### 01 전송과 교환

송신 호스트와 수신 호스트에 데이터를 전달하려면 전송과 교환 과정을 거쳐야 한다.
**교환**은 전달 경로가 둘 이상일 때 라우터에서 데이터를 어느 방향으로 전달할지를 선택하는 기능으로, 다양한 기준에 따라 데이터를 올바른 경로로 전달할 수 있도록 해준다.  
**전송**은 특정한 물리매체에 의하여 일대일(1:1)로 직접 연결된 두 시스템 간의 신뢰성 있는 데이터 전송을 보장하기 위한 것이다. 전송에는 라우팅 개념이 포함되지 않는다.



#### 전송방식의 종류

지리적 분포

- LAN
- MAN
- WAN

전송 교환기술에 의한 분류

- 점대점(Point-to-Point) - 각 호스트를 일대일로 직접 연결해 목적지 호스트에만 데이터를 전송
- 브로드캐스팅(Broadcasting) - 네트워크에 연결된 모든 호스트에 데이터를 전송



### 점대점 방식

점대점 방식은 전체 연결 개수가 많아지면 성능 면에서 유리하지만 전송 매체의 길이가 증가해 비용이 많이 든다. 반대로 연결 개수가 적어지면 전송 매체를 더 많이 공유해 네트워크 혼잡도가 증가한다. 따라서 네트워크 트래픽이 많이 발생하는 구간에서는 전송 매체의 수를 늘리고, 그렇지 않은 구간에서는 줄이는 것이 좋다.
![](https://ws3.sinaimg.cn/large/006tNc79ly1fntsn70xsyj30l40oqdnl.jpg)

**1. 스타형**

- 중앙에 있는 하나의 중개호스트 주위로 여러 호스트를 1:1로 연결
- 중앙 호스트의 성능과 신뢰성이 중요
- 트리형

**2. 링형**

- 호스트의 연결이 순환 구조를 이룸
- 모든 호스트가 전송과 교환 기능을 수행
- 시계방향 또는 반시계방향 선택 가능
- 현실적으로 한 방향으로만 전송
- 토큰
  - 데이터를 전송할 수 있는 권리
  - 데이터 전송을 원하는 호스트는 미리 토큰을 확보해야 함
  - 데이터 전송이 완료되면 호스트는 토큰을 반납해야 함
  - 데이터를 전송하는 호스트가 없으면 오직 하나의 토큰이 링을 순환함

**3. 완전형**



**4. 불규칙형**

### 브로드캐스팅

특정 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전달된다는 특징이 있다. WAM 같은 원거리 통신망에서는 특정 호스트 사이를 직접 연결한 전송 매체가 있는지, 아니면 어떤 우회 경로로 몃 단계를 거쳐서 연결할 수 있는지에 대한 판단이 중요하다. 그러나 LAN에서는 연결의 존재 여부보다는 데이터를 목적지 호스트까지 얼마나 효율적으로 전달할 수 있는지가 중요한 잣대가 된다. 이를 지원하는 브로드캐스팅 방식은 네트워크의 모든 호스트를 하나의 전송 매체로 연결하므로, 중개 기능을 수행하는 교환 호스트가 필요없다.

![](https://ws1.sinaimg.cn/large/006tNc79ly1fntsnbr7msj30ve0hetds.jpg)

- 주로 LAN환경에서 사용되며, 버스형과 링형이 존재한다.

#### 버스형

- 공유 버스에 모든 호스트를 연결
- 둘 이상의 호스트가 데이터를 전송하면 충돌 발생
- 충돌 문제의 해결 방법
  - 사전 예약 : 전송 시간대를 다르게 하는 방법과 토큰 제어 방식이 가능
  - 사후 해결 : 충돌을 감지하는 기능이 필요(예: 이더넷)

#### 링형

- 호스트를 순환 구조로 연결
- 송신 호스트가 전송한 데이터는 링을 한 바퀴 순환한 후 송신호스트에 되돌아옴
- 중간에 호스트 중에서 수신 호스트로 지정된 호스트만 데이터를 내부에 저장
- 데이터를 전송하기 위해서는 토큰 확보가 필수



###  멀티포인트 통신

컴퓨터 통신의 가장 기본적인 형식은 두 호스트 사이의 데이터 전송을 의미하는 유니캐스팅(Unicasting) 방식이다. 인터넷에서 제공되는 텔넷, FTP, 웹 검색과 같은 대부분의 서비스는 유니캐스팅 방식을 사용한다.

 최근의 인터넷 통신 환경은 통신 주체 하나가 다수의 상대방과 통신하는 일대다(1:n)형식뿐 아니라, 다수와 다수가 통신하는 다대다(n:n)형식의 다양한 멀티포인트(MultiPoint)서비스를 요구한다. 화상 회의, 원격 교육, 인터넷 채팅 등이 대표적인 예에 속한다.

즉, 하나의 송신 호스트를 기준으로, 수신 호스트 하나에 연결되면 유니포인트(Unipoint)가 되고,  
다수의 수신 호스트와 연결되면 멀티포인트(MultiPoint)가 된다. 

송신 호스트가 한 번의 전송으로 수신 호스트 하나에만 데이터를 전송할 수 있으면 유니캐스팅(Unicastring)이고, 다수의 수신 호스트에 전송할 수 있으면 멀티 캐스팅(Multicastring)이다.



#### 멀티포인트 유니캐스팅

- 유니캐스팅 방식을 이용하여 일대다 통신을 지원

- 호스트 a가 호스트 d,e,f에게 데이터를 전송하려면 3번의 송신절차가 필요

- 수신 호스트의 수가 증가하면 성능에 문제점 발생

  ![](https://ws3.sinaimg.cn/large/006tNc79ly1fntsyz8oe0j30nw0ciwhb.jpg)

#### 브로드캐스팅

- 네트워크에 연결된 모든호스트에게 데이터 전송
- 자신을 목적지로 하는 호스트만 데이터를 내부에 저장하고, 다른 호스트는 데이터를 무시함.

![](https://ws1.sinaimg.cn/large/006tNc79ly1fntt1pm0pfj30je09yabr.jpg)

#### 멀티캐스팅

- 1:다 전송 기능을 지원
- 송신 호스트는 한번의 데이터 전송으로 여러 호스트에게 데이터를 전송할 수 있음.
- 예: 송신 호스트 a, 수신호스트 d,e,f
- 인터넷 뉴스 인터넷 주식
- 멀티캐스팅을 구현하려면 멀티캐스트 그룹을 생성하고 관리하는 기능이 필요하다. 예를 들어, 임의의 호스트가 특정 멀티캐스트 테이터를 중개하는 라우터에 멀티캐스트 그룹 주소를 인식하고, 다수의 수신호스트에 중개하는 등의 멀티캐스트 트래픽에 대한 처리 기능도 구현되어야 한다.



![](https://ws2.sinaimg.cn/large/006tNc79ly1fntt1ud4fbj30li0dajud.jpg)



*전송과 교환 (멀티포인트 통신)*
*멀티포인트 유니캐스팅 / 브로드캐스팅 / 멀티캐스팅*



### 02 오류 제어

 데이터 링크 계층 프로토콜이 전송 오류 기능을 제공하려면 우선 오류 발생 여부를 인지할 수 있어야 한다. 오류의 종류에는 데이터가 깨져서 도착하는 프레임 변형과 데이터가 목적지에 도착하지 못하는 프레임 분실이 있다. 오류를 감지하면 오류를 복구하는 과정이 진행되는데, 컴퓨터 네트워크에서는 일반적으로 송신 호스트가 원래의 데이터를 재전송하는 기법을 사용한다.  

#### 전송 오류의 유형

 전송 프레임의 오류를 극복하고, 상위 계층에 신뢰성 있는 전송 서비스를 제공하려면 다음과 같은 기본 기능을 이용해 오류 복구 기능을 제공해야 한다.

- 수신 호스트의 응답 프레임
  송신 호스트가 전송한 데이터 프레임의 일부가 깨지는 프레임 변형 호유를 확인한 수신 호스트는 송신 호스트에 응답 프레임을 전송해 원래의 데이터 프레임을 재전송하도록 요구할 수 있다. 수신 호스트가 전송하는 응답 프레임의 종류에는 데이터 프레임이 정상적으로 도착했을 때 회신하는 **긍정 응답 프레임**과 데이터 프레임이 깨졌을 때 회신하는 **부정 응답 프레임**이 있다. 송신 호스트의 재전송 기능은 수신 호스트의 부정 응답 프레임 회신에 의해 이루어 진다.

- 송신 호스트의 타이머 기능
  송신 호스트가 전송한 데이터 프레임이 수신 호스트에 도착하지 못하는 프레임 분실 오류가 발생하면 수신 호스트는 이 사실을 인지할 수 없다. 따라서 오류 복구 과정이 송신 호스트 주도로 이루어져야 한다.  송신 호스트는 데이터 프레임을 전송한 후에 일정 시간 이내에 수신 호스트로부터 긍정 응답 프레임 회신이 없으면 **타임아웃기능을** 동작시켜 데이터 프레임을 재전송한다.

- 순서 번호 기능

  긍정 응답을 분실되는 경우 재전송으로 인한 중복 수신 가능. 데이터 프레임은 원래의 데이터 외에 오류 검출의 위한 정보도 함께 제공한다. 오류 검출을 위한 정보에는 수신 호스트가 데이터 프레임을 올바로 수신하면 송신 호스트에 **긍정 응답**프레임을 보냄으로써, 송수신 호스트 사이의 전송이 완결된다. 그러나 프레임 변형 오류가 발생하면 부정응답프레임을 회신해 송신 호스트의 재전송 기능에 따라 오류 복구 과정을 진행한다.

  ​

  ![](https://ws1.sinaimg.cn/large/006tNc79ly1fntu6z2e3ej31560rq44n.jpg)

  ![](https://ws3.sinaimg.cn/large/006tNc79ly1fntu6y4lk7j315i0qin4d.jpg)

*전송오류가 날 수 있는 2가지 유형과 이를 해결하기 위해서는 어떻게 해야될까?*

### 03 흐름제어

오류제어와 함께 데이터 링크 계층에서 제공하는 주요 기능은 데이터 프레임의 전송 속도를 조절하는 것이다. 송신 호스트는 수신 호스트가 감당할 수 있을 정도의 전송 속도를 유지하면서 데이터 프레임을 전송해야 하는데, 이러한 기능을 **흐름제어**라 한다. 흐름 제어는 송신 호스트가 수신 호스트보다 아주 빨리 데이터를 전송하는 경우에 필요하다.

흐름 제어 기능을 제공하지 않으면 수신 호스트는 자신에게 도착한 데이터 프레임을 내부 버퍼에 보관할 여유를 갖지 못한다. 따라서 전송 매체를 통해 올바르게 도착한 프레임이 분실되는 결과를 초래할 수 있다. 흐름 제어 기능의 부재에 따른 프레임 분실은 앞서 설명한 전송 오류의 프레임 분실과 동일한 결과를 가져오기 때문에 이것도 데이터를 재전송하는 방법으로 복구해야 한다.

흐름 제어의 기본 원리는 수신 호스트가 다음에 수신할 데이터 프레임의 전송 시점을 송신 호스트에 통지하는 방식이다. 가장 많이 사용하는 흐름제어 프로토콜의 예는 **슬라이딩 원도우 프로토콜**이다.



## 프레임

데이터 링크 계층에서는 전송 데이터를 프레임(Frame)이라는 작은 단위로 나누어 처리한다. 전송 프레임에는 상위 계층에서 보낸 전송 데이터를 오류를 확인하기 위한 체크섬(Checksum), 송수신 호스트의 주소, 기타 프로토콜에서 사용하는 제어 코드 같은 정보가 포함된다.

프레임 내용을 포함되는 정보는 프로토콜의 용도에 따라 다르다.
일반적으로 프레임은 내부정보를 표현하는 방식에 따라 **문자 프레임**과 **비트 프레임**으로 구분된다.

- 전송 데이터
- 오류 확인을 위한 체크썸(CheckSum)
- 송수신호스트 주소
- 기타 프로토콜에서 사용되는 제어코드 같은 정보 포함

**문자 프레임**

- 프레임의 내용이 문자로만 구성됨, 프레임의 시작과 끝에 특수 문자 사용한다.

  - 시작 : DLE / STX  끝 : DEL /ETX

- 전송 데이터에 특수문자가 포함되면 혼선이 발생 그래서 이를 예방하기 위해서 문자 스터핑을 활용한다.

  - 문자 스터핑(stuffing) 

    : 데이터에 DLE가 있으면 강제로 DLE하나 더 추가.  
    : 수신측에서는 두 개의 DLE가 나오면 뒤에 있는 DLE 제거  

![](https://ws3.sinaimg.cn/large/006tNc79ly1fntv47sz4yj30o40h4dnd.jpg)

**비트 프레임**

- 임의의 비트 패턴 전송 가능
- 프레임의 시작과 끝을 나타내는 플래그(flag)사용
- 전송 데이터에 플래그와 같은 패턴이 등장할 수 있음
  - 비트 스터핑
    : 1이 연속해서 5개 발생하면 강제로 0 추가

![](https://ws3.sinaimg.cn/large/006tNc79ly1fntv4ytbt7j30nu0pkgtj.jpg)

*문자스터핑과 비트 스터핑의 개념을 말하고, 어떻게 해결하는지 밑에꺼를 보고 해결하시오~*



## 다항 코드

프레임 전송 과정에서 발생하는 오류를 극복하는 방법은 크게 두 가지이다.

 첫 번째 방법은 전송 프레임에 오류 검출 코드를 넣어 수신 호스트가 전송 과정의 오류를 검출하도록 하는 것이다. 



이 방법의 오류 복구는 주로 재전송으로 이루어진다. 가장 간단한 오류 검출 코드 방법은 패리티 비트를 추가하는 것이며, 컴퓨터 네트워크에서는 일반적으로 다항 코드 방식을 사용합니다.

오류를 극복하는 두 번째 방법은 프레임에 오류 복구 코드를 넣어 수신 호스트가 오류 검출과 복구 기능을 모두 수행하도록 하는 것이다. 예를 들어, **해밍 코드(Hamming Code)**는 1비트 오류를 검출하고 복구하는 기능이 있다. 오류 복구 코드를 사용해 수신 호스트가 오류 복구 기능을 수행하는 방식을 **순방향 오류 복구**(FEC, Forward Error Correction)

### 1. 오류 검출

네트워크에서는 일반적으로 오류 복구 코드를 이용한 순방향 오류 복구 방식은 사용하지 않고, 재전송(Retransmission)방식을 이용해 오류를 복구한다. 이를 역방향 오류 복구(BEC, Backward Error Correction) 또는 ARQ(Automatic Repeat reQuest)방식이라 한다.

역방향 오류 복구 기능을 수행하려면 수신한 프레임에 오류가 있는지 판단할 수 있어야 한다. 이를 위해서는 송신 호스트가 오류를 검출하기 위한 코드를 전송 데이터와 함계 송신해야 한다. **오류 검출 코드는 패리티 비트, 블록 검사, 다항 코드 등을 이용해 생성 할 수 있다.**



#### 1.1 패리티(Parity)

1바이트(8비트) 구조에서 패리티(Parity)비트는 7비트의 ASCII코드를 제외한 나머지 1비트이다. 패리티 비트는 전송과정에서 1비트 오류를 검출하기 위한 것으로, 패리티 비트를 포함해 1의 개수가 짝수나 홀수 개가 되도록 한다.

데이터 전송과정에서 1비트 오류가 발생하면 1의 개수가 홀수 개로 바뀐다. 예를 들어, 위의 데이터 전송과정에서 세번째 비트가 0에서 1로 바뀌면 수신 호스트는 11110010을 받는다. 수신 호스트는 패리티 검사를 통해 1의 개수가 홀수로 변경된 사실을 알게되어 데이터 전송 과정에서 1비트 오류를 발생했음을 확인할 수 있다.
![](https://ws1.sinaimg.cn/large/006tNc79ly1fntvoqkm3ej30ey0bw0v4.jpg)

#### 1.2 블록 검사(Block sum check)

![](https://ws3.sinaimg.cn/large/006tNc79ly1fntvouk9w8j30e60fc42m.jpg)

 패리티 방식을 이용한 오류 검출 기법은 1비트 오류를 간단히 적용할 수 있다. 그러나 짝수 개의 비트에서 오류가 발생하면 오류가 검출되지 않는다는 문제점이 있다. 예를 들어, 2비트의 데이터가 깨지면 1의 개수는 원래의 데이터와 같은 짝수나 홀수를 유지한다. 다수의 비트에서 오류가 발생할 때 오류를 검출하는 방법으로는 패리티 방식을 개선한 **블록검사**가 있다. 



### 2 다항코드(Polynomial Code)

**CRC(Cyclic Redundancy Code)**라고도 알려진 다항코드 방식은 현재의 통신 프로콜에서 가장 많이 사용하는 오류 검출 기법이다. 특히 일반 네트워크에서 발생하는 오류는 특정 위치에서 집중적으로 발생하는 버스트 에러 형태인 경우가 많은데, 다항 코드 방식은 이런 오류를 검출하는 확률이 높은 것으로 알려져 있다.

#### 2.1 생성 다항식

송신 호스트가 전송할 데이터가 m비트의 M(x)라면 데이터 전송 과정에서 n+1비트의 생성 다항식 G(X)를 사용해 오류 검출 코드를 생성함으로써 오류 제어 기능을 수행한다. 수신 호스트는 전송 데이터M(x)를 생성 다항식G(x)로 나누어 체크섬 정보를 얻는다. 나눈기 연산과정에서는 전송 데이터 뒤에 나머지를 보관할 n비트의 공간을 확보하고, 이 자리를 모두 0으로 채운 후에 나누기 연산을 수행한다. 연산에서 얻은 나버지 값을 체크섬이라 정의하며, 체크섬을 전송 데이터의 뒤에 추가해 추신 데이터에 전송해야 한다. 

#### 2.2 체크섬



![](https://ws3.sinaimg.cn/large/006tNc79ly1fntvx4beg5j31340mcn6r.jpg)





